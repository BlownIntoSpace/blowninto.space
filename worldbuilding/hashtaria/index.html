<!DOCTYPE html>
<html lang="en">
<head>
    <base target="_top">
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1">

    <title>Quick Start - Leaflet</title>

    <link rel="shortcut icon" type="image/x-icon" href="docs/images/favicon.ico" />

    <link rel="stylesheet" href="https://unpkg.com/leaflet@1.9.3/dist/leaflet.css" integrity="sha256-kLaT2GOSpHechhsozzB+flnD+zUyjE2LlfWPgU04xyI=" crossorigin=""/>
    <script src="https://unpkg.com/leaflet@1.9.3/dist/leaflet.js" integrity="sha256-WBkoXOwTeyKclOHuWtc+i2uENFpDZ9YPdf5Hf+D7ewM=" crossorigin=""></script>

    <style>

        html, body {
            height: 100%;
            margin: 0;
        }
    </style>


</head>
<body>



<div id="map" style="width: 100%; height: 100%;"></div>
<script>
    // for use with browserify / webpack
    var L = require('leaflet')
    L.RasterCoords = require('leaflet-rastercoords')

    var img = [
        11352,  // original width of image (here from `example/karta.jpg`)
        15994   // original height of image
    ]
    // create the map
    var map = L.map('map', {
        crs: L.CRS.Simple
    })

    // assign map and image dimensions
    var rc = new L.RasterCoords(map, img)
    // set max zoom Level (might be `x` if gdal2tiles was called with `-z 0-x` option)
    map.setMaxZoom(rc.zoomLevel())
    // all coordinates need to be unprojected using the `unproject` method
    // set the view in the lower right edge of the image
    map.setView(rc.unproject([img[0], img[1]]), 2)

    // set markers on click events in the map
    map.on('click', function (event) {
        // any position in leaflet needs to be projected to obtain the image coordinates
        var coords = rc.project(event.latlng)
        var marker = L.marker(rc.unproject(coords))
            .addTo(map)
        marker.bindPopup('[' + Math.floor(coords.x) + ',' + Math.floor(coords.y) + ']')
            .openPopup()
    })

    // the tile layer containing the image generated with `gdal2tiles --leaflet -p raster -w none <img> tiles`
    L.tileLayer('/tiles/{z}/{x}/{y}.png', {
        noWrap: true,
        bounds: rc.getMaxBounds(),
        maxNativeZoom: rc.zoomLevel()
    }).addTo(map)

</script>



</body>
</html>
